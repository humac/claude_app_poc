# Backend Configuration
PORT=3001
NODE_ENV=production

# Database Configuration (optional - defaults to ./backend/data)
# DATA_DIR=/app/data

# PostgreSQL Configuration (optional)
# DB_CLIENT=postgres
# POSTGRES_URL=postgresql://username:password@localhost:5432/database_name

# PostgreSQL SSL Configuration
# Enable SSL for PostgreSQL connections
# POSTGRES_SSL=true

# SSL Certificate Validation (Security: defaults to true for production safety)
# Set to 'false' only in development/testing environments with self-signed certificates
# NEVER set to 'false' in production - this enables MITM attacks
# POSTGRES_SSL_REJECT_UNAUTHORIZED=true

# Optional: Path to custom CA certificate file for SSL verification
# POSTGRES_SSL_CA=/path/to/ca-certificate.crt

# Optional: Client certificate authentication (mutual TLS)
# POSTGRES_SSL_CERT=/path/to/client-certificate.crt
# POSTGRES_SSL_KEY=/path/to/client-key.key

# Encryption Configuration
# ACS_MASTER_KEY is required for encrypting sensitive data at rest (e.g., SMTP passwords)
# Generate a 256-bit (32-byte) key with: node -e "console.log(require('crypto').randomBytes(32).toString('base64'))"
# ACS_MASTER_KEY=your-generated-key-here

# ====================
# Proxy & Rate Limiting Configuration
# ====================
# Trust proxy - Enable when behind reverse proxy (Cloudflare, nginx, load balancer)
# Set to 'true' if your app is behind a proxy
TRUST_PROXY=true

# Proxy type - Determines which IP header to use for rate limiting
# Options: cloudflare | standard | none
# - cloudflare: Uses CF-Connecting-IP header (for Cloudflare deployments)
# - standard: Uses X-Forwarded-For header (for nginx, ALB, etc.)
# - none: Direct connection, no proxy
PROXY_TYPE=cloudflare

# Proxy trust level - How many proxy hops to trust
# Examples: 1 (single proxy), 2 (load balancer + proxy), true (trust all)
PROXY_TRUST_LEVEL=1

# Rate Limiting - Protect against abuse and DDoS
RATE_LIMIT_ENABLED=true
RATE_LIMIT_WINDOW_MS=900000  # 15 minutes in milliseconds
RATE_LIMIT_MAX_REQUESTS=100  # Maximum requests per window per IP

# ====================
# Attestation Scheduler Configuration
# ====================
# Enable automated attestation reminders and escalations
# When enabled, runs daily checks for:
# - Sending reminder emails to employees with pending attestations
# - Escalating overdue attestations to managers
# - Auto-closing campaigns past their end date
RUN_ATTESTATION_SCHEDULER=true

# Frontend URL for generating links in emails (attestations, password reset, etc.)
# Fallback chain: branding.app_url (from database) -> FRONTEND_URL -> BASE_URL -> localhost:3000
FRONTEND_URL=http://localhost:5173
